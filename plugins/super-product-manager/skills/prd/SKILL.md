---
name: prd
description: PRD 编写技能。用于输出完整需求文档结构、假设与验收标准。
model: sonnet
version: "1.2.0"
scope: skill
inputs:
  - 用户问题或场景
  - 约束与目标（如有）
outputs:
  - 方法与模板
  - 注意事项与检查项
evidence: optional
references:
  - ./references/feature-prd.md
  - ./references/data-prd.md
  - ./references/api-prd.md
  - ./references/general-prd.md
---
# prd

## 延迟加载规则

- 默认只使用本文件内容
- 只有在用户明确要求细节或需要模板时，才加载 references 中的附件
- 未加载附件时，先给摘要与下一步

## 核心说明

PRD 编写技能。用于输出完整需求文档结构、假设与验收标准。

---

## PRD 类型识别

### 识别规则

先识别PRD类型，并按规则加载对应附件：

| 类型 | 触发关键词 | 侧重点 |
|-----|----------|--------|
| **功能PRD** | 用户功能、交互、业务流程 | 用户价值、业务逻辑、交互流程 |
| **数据PRD** | 数据埋点、分析、指标 | 数据指标、埋点方案、分析框架 |
| **API PRD** | 接口对接、第三方集成 | 接口规格、数据结构、调用流程 |
| **通用PRD** | 综合项目、无法分类 | 全面覆盖、平衡各类需求 |

### 识别示例

**功能PRD示例**：
- "用户评论功能"
- "登录注册流程"
- "购物车优化"
- "用户个人中心"

**数据PRD示例**：
- "用户行为数据埋点"
- "数据分析看板"
- "核心指标监控"
- "漏斗分析方案"

**API PRD示例**：
- "微信支付对接"
- "第三方登录集成"
- "开放API设计"
- "内部服务接口"

**通用PRD示例**：
- "完整的项目需求"
- "系统升级改造"
- "综合性功能模块"

---

## 快速决策树

**从用户输入开始**：

```
用户输入
    │
    ├── 提到"数据/埋点/指标/分析"？
    │   └── 是 → 数据PRD
    │
    ├── 提到"对接/接口/API/第三方"？
    │   └── 是 → API PRD
    │
    ├── 提到"用户/功能/交互/流程"？
    │   └── 是 → 功能PRD
    │
    └── 综合性或无法判断？
        └── → 通用PRD
```

---

## 示例对话

### 示例1：功能PRD

**用户输入**：
> 帮我写一个用户评论功能的PRD，包含评论发布、回复、点赞功能

**技能输出**：
- **PRD类型**：功能PRD
- **加载模板**：feature-prd.md
- **核心内容**：
  - 背景与目标：提升用户互动和内容沉淀
  - 用户故事：作为用户，我想发布评论以便表达观点
  - 功能范围：评论、回复、点赞（In范围）
  - 详细需求：评论发布流程、审核机制、通知推送
  - 验收标准：评论成功率、审核响应时间

### 示例2：数据PRD

**用户输入**：
> 需要设计用户行为分析的数据埋点方案，核心是追踪用户在APP内的行为路径

**技能输出**：
- **PRD类型**：数据PRD
- **加载模板**：data-prd.md
- **核心内容**：
  - 业务问题：需要了解用户行为路径以优化产品
  - 核心指标：页面访问深度、停留时长、转化率
  - 埋点方案：页面浏览、点击事件、停留时长
  - 分析框架：漏斗分析、路径分析、留存分析
  - 验收标准：埋点准确率≥95%

### 示例3：API PRD

**用户输入**：
> 需要对接微信支付接口，支持小程序支付和H5支付

**技能输出**：
- **PRD类型**：API PRD
- **加载模板**：api-prd.md
- **核心内容**：
  - 接口概述：对接微信支付系统
  - 接口列表：统一下单、查询订单、关闭订单、支付回调
  - 接口详情：请求参数、响应格式、错误码
  - 业务逻辑：支付流程、回调处理、对账机制
  - 验证标准：支付成功率、回调处理时间

---

## 技能衔接

### 前置技能

| 技能 | 作用 | 输出 |
|-----|------|------|
| **idea-concretization** | 想法具体化 | 具体化的用户/问题/价值/假设 |
| **market-validation** | 市场验证 | 验证结论和证据支持 |

### 后续技能

| 技能 | 作用 | 输入 |
|-----|------|------|
| **tech-spec** | 技术规格 | PRD中的技术需求 |
| **user-story** | 用户故事拆解 | PRD中的功能需求 |
| **roadmap** | 产品路线图 | PRD中的时间规划 |

### 典型流程

```
idea-concretization（想法具体化）
    ↓ 具体化想法和假设
market-validation（市场验证）
    ↓ 验证结论和数据
prd（编写PRD）← 当前技能
    ↓ 完整需求文档
tech-spec（技术规格）
user-story（用户故事）
roadmap（产品路线图）
```

---

## 输出结构（概览）

- **PRD类型识别结果**：功能/数据/API/通用
- **完整PRD文档**：根据类型加载对应模板
- **验收标准**：可测试的验收条件
- **风险与依赖**：技术依赖和风险评估
- **下一步建议**：后续技能推荐

---

## 质量检查清单

### 完整性检查

**文档信息**：
- [ ] 版本号和日期
- [ ] 负责人信息
- [ ] 文档状态

**核心内容**：
- [ ] 背景和目标清晰
- [ ] 需求描述具体可验证
- [ ] 验收标准明确
- [ ] 风险和依赖已识别

### 质量检查

**需求质量**：
- [ ] 需求不模糊（避免"可能"、"大概"）
- [ ] 验收可测试（可量化/可观察）
- [ ] 范围有边界（In/Out清晰）
- [ ] 指标可追踪（有数据来源）

**文档质量**：
- [ ] 结构完整（涵盖必要章节）
- [ ] 逻辑一致（前后呼应）
- [ ] 可读性强（清晰易懂）

---

## 常见错误

| 错误 | 问题 | 正确做法 |
|-----|------|---------|
| **需求模糊** | "提升用户体验" | "注册转化率提升20%" |
| **范围不清** | 边界不明确 | 明确In/Out列表 |
| **验收无法测** | "用户喜欢" | "NPS ≥ 40" |
| **忽视依赖** | 不考虑限制条件 | 列出所有依赖和风险 |
| **过度设计** | 一次性做太多 | MVP优先，迭代 |
| **版本混乱** | 不记录变更 | 维护版本历史 |

---

## 最佳实践

### 1. 先写假设

在 market-validation 之前写 PRD 时，标注假设内容：
```markdown
**假设**：用户愿意在注册时提供手机号
**验证方式**：A/B测试，对比提供手机号和不提供的转化率
```

### 2. 版本管理

PRD 变更时更新版本号和变更记录：
```markdown
## 变更记录
| 版本 | 日期 | 变更内容 | 变更人 |
|-----|------|---------|-------|
| v1.1 | 2025-01-15 | 新增XX功能 | 张三 |
```

### 3. 干系人对齐

与以下角色达成共识：
- **开发**：技术可行性
- **设计**：交互方案
- **测试**：验收标准
- **运营**：上线计划

### 4. 可测试优先

每个需求都应有验收标准：
```markdown
**需求**：用户可以发布评论
**验收**：
- [ ] 评论提交后3秒内显示
- [ ] 敏感词过滤准确率≥95%
- [ ] 评论成功率≥99%
```

### 5. 数据驱动

用数据支撑决策和验证：
```markdown
**决策依据**：根据数据分析，80%用户在首页会点击推荐内容
**验证指标**：上线后追踪点击率，目标提升至85%
```

---

## 可用模板

| PRD类型 | 模板文件 | 适用场景 | 特点 |
|---------|---------|---------|------|
| **功能PRD** | feature-prd.md | 用户功能、业务流程 | 侧重用户价值和交互 |
| **数据PRD** | data-prd.md | 数据埋点、分析需求 | 侧重数据指标和埋点 |
| **API PRD** | api-prd.md | 接口对接、第三方集成 | 侧重接口规格和技术 |
| **通用PRD** | general-prd.md | 综合项目、不确定类型 | 全面覆盖，平衡各类需求 |

---

## 快速参考

### PRD 核心章节（必备）

1. **文档信息**：版本、负责人、状态
2. **背景与目标**：为什么做、要达成什么
3. **需求描述**：具体做什么
4. **功能规格**：如何实现
5. **验收标准**：如何验证成功
6. **风险与依赖**：什么可能出问题

### 根据类型补充章节

**功能PRD补充**：
- 用户故事
- 交互流程
- 交互原型

**数据PRD补充**：
- 数据指标定义
- 埋点方案
- 分析框架

**API PRD补充**：
- 接口列表
- 接口详情
- 错误处理
- 安全要求

**通用PRD补充**：
- 用户分析
- 非功能需求
- 完整的上线计划

---

## 分段式 PRD 组织规则

### 适用场景

当 PRD 文档过大（超过模型 token 限制）或需要多人/多技能协作编辑时，可将 PRD 拆分为多个章节文件。

### 目录结构

```
/项目/docs/prd/
├── _index.md           # 索引文件（必读）：目录 + 各章节摘要
├── 01-background.md    # 背景与目标
├── 02-user-analysis.md # 用户分析 / 用户故事
├── 03-requirements.md  # 功能范围 / 需求描述
├── 04-specification.md # 详细需求 / 功能规格
├── 05-acceptance.md    # 验收标准
├── 06-metrics.md       # 数据指标
├── 07-non-functional.md# 非功能需求
├── 08-dependencies.md  # 依赖与风险
├── 09-launch-plan.md   # 上线计划
└── 10-appendix.md      # 附录
```

### 加载策略

1. **索引优先**：始终先读取 `_index.md` 了解整体结构和各章节摘要
2. **按需加载**：根据任务只加载需要的章节文件
3. **局部编辑**：修改特定章节时，只加载并编辑该章节文件

### 协作约束

- **不扩展结构**：PRD 只按既有模板章节输出，不新增章节
- **仅补充已存在章节**：只有 PRD 已包含某章节，才允许对应技能补充内容
- **保持一致性**：编辑后检查术语、引用是否与其他章节一致

---

## 章节→技能协作映射

以下映射表定义了"哪些技能可以补充哪些 PRD 章节"。**只有 PRD 模板已包含的章节才允许补充**。

| PRD 章节 | 可补充技能 | 补充内容 |
|---------|-----------|---------|
| **背景与目标**（目标用户部分） | `persona` | 用户画像、用户特征、核心诉求 |
| **用户故事 / 用户分析** | `persona`, `user-story` | 用户角色、用户故事、验收标准 |
| **功能范围 / 需求描述**（优先级部分） | `prioritization` | 功能优先级排序（RICE/ICE/MoSCoW） |
| **数据指标** | `data-driven` | 北极星指标、AARRR漏斗、埋点设计 |
| **非功能需求** | `tech-spec` | 性能要求、安全要求、技术规格 |
| **依赖与风险**（技术部分） | `tech-spec` | 技术依赖、技术风险、应对措施 |
| **上线计划** | `roadmap`, `launch` | 里程碑规划、灰度方案、上线检查 |

### 协作流程

1. **识别章节**：确定要补充/编辑的 PRD 章节
2. **调用技能**：根据映射表调用对应技能
3. **局部更新**：技能输出直接更新目标章节文件
4. **一致性检查**：更新后检查与其他章节的一致性

### 禁止行为

- ❌ 技能输出新增 PRD 模板不存在的章节
- ❌ 跨章节职责混用（如用 `persona` 技能编辑"非功能需求"）
- ❌ 未读取目标章节就直接覆盖

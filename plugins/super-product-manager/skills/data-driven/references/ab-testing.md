# A/B 测试设计

## A/B 测试流程

```
1. 假设 → 2. 设计 → 3. 实施 → 4. 分析 → 5. 决策
```

---

## Step 1：形成假设

### 假设公式

```markdown
我们相信：[改变 X]
会导致：[指标 Y 提升 Z%]
因为：[原因/依据]
```

### 假设来源

| 来源 | 示例 |
|-----|------|
| 用户反馈 | 用户说注册流程太长 |
| 数据分析 | 漏斗数据显示某步骤流失严重 |
| 竞品分析 | 竞品的做法效果更好 |
| 行业最佳实践 | 研究表明 X 有效 |
| 直觉/经验 | 团队认为 X 可能有效 |

### 假设质量检查

| 检查项 | 要求 |
|-------|------|
| 可测量 | 有明确的指标 |
| 可验证 | 能在短期内验证 |
| 有依据 | 不是纯拍脑袋 |
| 有价值 | 验证结果对决策有帮助 |

---

## Step 2：设计实验

### A/B 测试方案模板

```markdown
## A/B 测试方案

### 基本信息
- **测试名称**：[名称]
- **负责人**：[谁]
- **测试周期**：[开始日期] ~ [预计结束日期]
- **最小测试周期**：[X 天/周]

### 假设
**我们相信**：[改变 X]
**会导致**：[指标 Y 提升 Z%]
**因为**：[原因]

### 测试设计

**对照组 (A)**：
[现有方案描述]
[截图/原型链接]

**实验组 (B)**：
[新方案描述]
[截图/原型链接]

**流量分配**：
- 对照组：50%
- 实验组：50%
- 分流方式：[用户ID哈希/随机分配]

### 目标用户
- 用户类型：[新用户/老用户/全部]
- 平台：[iOS/Android/Web/全部]
- 地区：[全部/特定地区]

### 衡量指标

**主要指标（Primary Metric）**：
[最重要的一个指标，决定实验成败]

**次要指标（Secondary Metrics）**：
- [指标1]：期望 [上升/下降/不变]
- [指标2]：期望 [上升/下降/不变]

**护栏指标（Guardrail Metrics）**：
[这些指标不能变差，否则即使主指标提升也不能上线]
- [指标1]：不能低于 [阈值]
- [指标2]：不能低于 [阈值]

### 样本量计算

| 参数 | 值 |
|-----|-----|
| 当前转化率 | X% |
| 期望提升 | +Y% |
| 统计显著性 | 95% (α=0.05) |
| 统计功效 | 80% (β=0.2) |
| **最小样本量** | X 人/组 |
| 预计测试时间 | X 天 |

### 风险评估
| 风险 | 概率 | 影响 | 缓解措施 |
|-----|-----|-----|---------|
| [风险1] | 高/中/低 | 高/中/低 | [措施] |
| [风险2] | 高/中/低 | 高/中/低 | [措施] |

### 回滚方案
如果出现 [问题]，立即 [回滚步骤]
```

---

## Step 3：实施测试

### 实施检查清单

**上线前**：
- [ ] 埋点已部署且验证通过
- [ ] 分流逻辑已测试
- [ ] 关键路径功能正常
- [ ] 已设置监控告警
- [ ] 相关人员已知悉

**上线时**：
- [ ] 先小流量验证（5-10%）
- [ ] 确认数据正常采集
- [ ] 无严重 Bug
- [ ] 逐步放量到目标比例

**测试中**：
- [ ] 每日检查数据是否正常
- [ ] 监控护栏指标
- [ ] 不要中途偷看结果做决策

---

## Step 4：分析结果

### 结果记录模板

```markdown
## A/B 测试结果

### 测试信息
- 测试名称：[名称]
- 实际周期：[开始] ~ [结束]
- 实际样本量：对照组 X，实验组 Y

### 主要结果

| 指标 | 对照组 | 实验组 | 变化 | P值 | 结论 |
|-----|-------|-------|-----|-----|------|
| 主指标 | X% | Y% | +Z% | 0.0X | 显著/不显著 |
| 次指标1 | X% | Y% | +Z% | 0.0X | 显著/不显著 |
| 次指标2 | X% | Y% | +Z% | 0.0X | 显著/不显著 |
| 护栏指标 | X% | Y% | +Z% | 0.0X | 通过/不通过 |

### 分群分析

| 用户群 | 对照组 | 实验组 | 变化 | 洞察 |
|-------|-------|-------|-----|------|
| 新用户 | X% | Y% | +Z% | [洞察] |
| 老用户 | X% | Y% | +Z% | [洞察] |
| iOS | X% | Y% | +Z% | [洞察] |
| Android | X% | Y% | +Z% | [洞察] |

### 假设验证

**原假设**：
[改变 X] 会导致 [指标 Y 提升 Z%]

**验证结果**：
✅ 假设成立 / ❌ 假设不成立 / ❓ 结论不明确

**原因分析**：
[为什么结果是这样]
```

---

## Step 5：做出决策

### 决策矩阵

| 情况 | 决策 | 说明 |
|-----|------|------|
| 主指标显著提升，护栏指标通过 | ✅ 全量上线 | 最理想情况 |
| 主指标显著提升，护栏指标下降 | ⚠️ 评估权衡 | 需要决策取舍 |
| 主指标无显著变化 | ❌ 不上线 | 继续观察或放弃 |
| 主指标显著下降 | ❌ 回滚 | 保持现状 |

### 决策记录

```markdown
## 测试决策

**决策**：全量上线 / 继续测试 / 放弃

**理由**：
[做出这个决策的原因]

**后续行动**：
- [ ] [行动1]
- [ ] [行动2]

**学习收获**：
[这次实验我们学到了什么]
```

---

## A/B 测试注意事项

### 常见错误

| 错误 | 问题 | 正确做法 |
|-----|------|---------|
| **样本量不够** | 结论不可靠 | 至少 1000+ 样本/组 |
| **测试时间太短** | 没覆盖完整周期 | 至少 1-2 周 |
| **多变量干扰** | 不知道是哪个因素生效 | 一次只测一个变量 |
| **偷看结果** | p-hacking，假阳性 | 等测试结束再看 |
| **忽视护栏指标** | 主指标涨但整体变差 | 同时关注护栏指标 |
| **忽视分群差异** | 平均值掩盖问题 | 分群分析 |

### 什么时候不需要 A/B 测试

| 情况 | 原因 |
|-----|------|
| 用户量太小 | 无法达到统计显著 |
| 改动太小 | 效果可能低于最小可检测差异 |
| 紧急修复 | 没时间测试 |
| 显而易见的优化 | 比如修复明显的 Bug |
| 战略决策 | 不是优化而是方向选择 |

---

## 高级话题

### 多变量测试 (MVT)

当需要同时测试多个变量时：

```
变量1：按钮颜色 (红/蓝)
变量2：按钮文案 (立即购买/马上下单)

组合：
- 红 + 立即购买
- 红 + 马上下单
- 蓝 + 立即购买
- 蓝 + 马上下单
```

**缺点**：需要更大样本量

### 贝叶斯 vs 频率派

| 方法 | 优点 | 缺点 |
|-----|------|------|
| 频率派 | 成熟、普遍 | 需要预设样本量 |
| 贝叶斯 | 可以随时决策 | 需要先验假设 |

### 长期影响评估

短期 A/B 测试可能忽视：
- 新鲜效应：短期有效，长期衰减
- 学习效应：用户需要时间适应
- 网络效应：对社交功能的影响需要更长时间
